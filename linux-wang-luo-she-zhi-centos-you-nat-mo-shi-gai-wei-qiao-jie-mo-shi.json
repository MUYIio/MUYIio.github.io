{"title":"Linux网络设置-CentOS由NAT模式改为桥接模式","date":"2020-04-02T11:09:28.000Z","toc":true,"summary":"这篇文章主要记录将我们的Linux网络设置由NAT模式改为桥接模式。","source":"_posts/Linux网络设置-CentOS由NAT模式改为桥接模式.md","raw":"---\ntitle: Linux网络设置-CentOS由NAT模式改为桥接模式\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-04-02 19:09:28\npassword:\nsummary: 这篇文章主要记录将我们的Linux网络设置由NAT模式改为桥接模式。\ntags:\n- CentOS\n- NAT\n- Bridged\ncategories:\n- Linux\n---\n\n\n\n\n\nLinux版本：`CentOS`\n\nCentOS发行版本：`CentOS 8.1`\n\n虚拟机：`VMware`\n\n\n\n在前面CentOS 8.1安装教程中关于网络配置我们默认使用的是NAT模式，这篇文章主要记录将我们的Linux网络设置由NAT模式改为桥接模式（Bridged）。\n\n\n\n需要安装CentOS的朋友可以可以看这篇文章：\n\n\n\n[VMware 安装 CentOS 8.1 完整教程](https://muyiio.com/2020/03/05/vmware-an-zhuang-centos-8-1-wan-zheng-jiao-cheng/)\n\n\n\n## 1】NAT与Bridged区别\n\n- **NAT(网络地址转换模式)**\n\n虚拟机要联网得先通过宿主机才能和外面进行通信。\n\n\n\nNAT模式下的虚拟系统的TCP/IP配置信息是由VMnet8(NAT)虚拟网络的DHCP服务器提供的，无法进行手工修改，因此虚拟系统也就无法和本局域网中的其他真实主机进行通讯。使得虚拟局域网内的虚拟机在对外访问时，使用的则是宿主机的IP地址，这样从外部网络来  看，只能看到宿主机，完全看不到新建的虚拟局域网。就是虚拟系统会通过宿主机的网络来访问外网，而这里的宿主机相当于有两个网卡，一个是真实网卡，一个是虚拟网卡，真实网卡相当于链接了现实世界的真实路由器，而宿主机的虚拟网卡，相当于连接了一个可以认为是虚拟交换机。\n\n\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/1.png)\n\n\n\n**虚拟机可以上网可以ping通主机，但是主机ping不通虚拟机。**\n\n\n\n- **Bridged(桥接模式)**\n\n虚拟机和宿主机在网络上就是平级的关系，相当于连接在同一交换机上。\n\n需要手工为虚拟系统配置IP地址、子网掩码，而且还要和宿主机器处于同一网段，这样虚拟系统才能和宿主机器进行通信。以实现通过局域网的网关或路由器访问互联网。使用bridged模式的虚拟系统和宿主机器的关系，就像连接在同一个Hub上的两台电脑。相当于在一个局域网内创立了一个单独的主机，他可以访问这个局域网内的所有的主机，但是需要手动来配置IP地址，子网掩码，并且他是和真实主机在同一个网段（nat是两个网段）.\n\n\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/2.png)\n\n\n\n**这个模式里，虚拟机和宿主机可以互相ping通。**\n\n\n\n## 3】虚拟机网络设置\n\n**右键点击以管理员身份打开VMware，找到要更改网络的虚拟机。**\n\n- 点击左上角【编辑虚拟机设置】→【网络适配器】→选择【桥接模式】，并勾选【复制物理网络连接状】态\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/3.png)\n\n\n\n- 点击左上角【编辑E】→【虚拟网络编辑器】\n\n>  VMnet0、VMnet1、VMnet8，分别对应了桥接模式、仅主机模式、NAT模式。\n\n\n\n\n\n**选择【VMnet0】→【已桥接至】选择当前电脑连接的网络→【确定】**\n\n\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/4.png)\n\n\n\n\n\n## 3】CentOS网络设置\n\n- 查看自己电脑的IP网段（Win+R输入cmd再输入ipconfig）\n\n\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/5.png)\n\n\n\n**将 IPv4 地址、子网掩码 、默认网关保存后面用到。**\n\n\n\n\n\n- 打开虚拟机，以root账户登录CentOS\n\n1.由于我安装了图形界面，登录是这样：\n\n\n\n\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/6.png)\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/7.png)\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/8.png)\n\n\n\n说明：**倘若没有设置root账户，但登录的账户yyo拥有root权限，那就直接登陆。**\n\n\n\n2.没有安装图形界面登录简单一些，我就不演示了。\n\n\n\n\n\n- 获取权限\n\n```\nsudo -i\n```\n\n\n\n- 编辑配置ip地址信息文件（使用vi打开，CentOS自带vi）\n\n```\nvi /etc/sysconfig/network-scripts/ifcfg-ens33\n```\n\n\n\n可以看到我们的网络配置文件：\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/9.png)\n\n\n\n**按`i`进入编辑，按`方向键`移动**\n\n\n\n修改这两个值：\n\n```\nBOOTPROTO=static       #设置为手动分配IP地址\nONBOOT=yes\n```\n\n\n\n在`ONBOOT=yes`后面增加四个值（上面我们保存的ip）：\n\n```\nIPADDR=192.168.0.107   # 配置为局域网固定IP(IPv4 地址)\nNETMASK=255.255.255.0  # 配置子网掩码\nGATEWAY=192.168.0.1    # 配置局域网网关\nDNS1=8.8.8.8           # 配置首选DNS，8.8.8.8为免费DNS服务器的IP地址\n```\n\n\n\n**编辑完成后按`esc`退出，再按`:wq`保存（如果无法保存，就按`:wq！`强制保存）**\n\n\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/10.png)\n\n\n\n- 接下来修改第二个配置，输入下面这个命令\n\n```\nvi /etc/sysconfig/network\n```\n\n\n\n增加这四个配置：\n\n**按`i`进入编辑，按`方向键`移动**\n\n```\nNETWORKING=yes\nNETWORKING_IPV6=no            #关掉IPv6\nHOSTNAME=localhost.localdomain\nGATEWAY=192.168.0.1           #默认网关地址\n```\n\n\n\n**编辑完成后按`esc`退出，再按`:wq`保存**\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/11.png)\n\n\n\n- 启动network服务,输入下面这个命令\n\n```\nservice network restart\n```\n\n\n\n**使用CentOS 8.x 版本的就会有问题了，8以下的版本到这里就可以结束了。**\n\n\n\n事实上并没有启动network服务，而是：\n\n```\nRedirecting to /bin/systemctl reatart network.service\nFailed to restart network.service: Unit network.service not found\n```\n\n\n\n**查了很多资料才发现centos 8.x 已经替换了原来的network, 新版的叫：NetworkManager，下面给出解决办法**\n\n\n\n- 首先安装NetworkManager\n\n```\nyum install NetworkManager*\n```\n\n\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/12.png)\n\n\n\n- 启动NetworkManager\n\n```\nservice NetworkManager restart\n```\n\n\n\n- 开启NetworkManager网络服务\n\n\n\n```\nsystemctl status NetworkManager\n```\n\n\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/13.png)\n\n\n\n\n\n## 4】验证网络\n\n\n\n- 在Windows终端ping我们CentOS的IP：192.168.0.107，可以正常通信。\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/14.png)\n\n\n\n- 在CentOS验证一下，也是完全🆗\n\n\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/15.png)\n\n\n\n![](https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT模式改为桥接模式/16.png)\n\n\n\n**一番折腾下来，花费了不少时间，尤其是NetworkManager那里，都不想写这篇文章了，但是又想解决这个困难，希望对有需要朋友的有点帮助！**\n\n\n参考：\n\n[centos7输入systemctl status network.service出现Unit network.service could not be found的解决办法](https://blog.csdn.net/YXWik/article/details/103163492)\n\n\n[Failed to restart network.service: Unit network.service not found](https://blog.csdn.net/qq_40162735/article/details/101780012)","slug":"Linux网络设置-CentOS由NAT模式改为桥接模式","published":true,"updated":"2021-05-18T10:22:34.191Z","_id":"clq6dy497001kikw09ltvpsib","comments":true,"layout":"post","photos":[],"link":"","html":"<p>Linux版本：<code>CentOS</code></p>\n<p>CentOS发行版本：<code>CentOS 8.1</code></p>\n<p>虚拟机：<code>VMware</code></p>\n<p>在前面CentOS 8.1安装教程中关于网络配置我们默认使用的是NAT模式，这篇文章主要记录将我们的Linux网络设置由NAT模式改为桥接模式（Bridged）。</p>\n<p>需要安装CentOS的朋友可以可以看这篇文章：</p>\n<p><a href=\"https://muyiio.com/2020/03/05/vmware-an-zhuang-centos-8-1-wan-zheng-jiao-cheng/\" target=\"_blank\" rel=\"noopener\">VMware 安装 CentOS 8.1 完整教程</a></p>\n<h2 id=\"1】NAT与Bridged区别\"><a href=\"#1】NAT与Bridged区别\" class=\"headerlink\" title=\"1】NAT与Bridged区别\"></a>1】NAT与Bridged区别</h2><ul>\n<li><strong>NAT(网络地址转换模式)</strong></li>\n</ul>\n<p>虚拟机要联网得先通过宿主机才能和外面进行通信。</p>\n<p>NAT模式下的虚拟系统的TCP/IP配置信息是由VMnet8(NAT)虚拟网络的DHCP服务器提供的，无法进行手工修改，因此虚拟系统也就无法和本局域网中的其他真实主机进行通讯。使得虚拟局域网内的虚拟机在对外访问时，使用的则是宿主机的IP地址，这样从外部网络来  看，只能看到宿主机，完全看不到新建的虚拟局域网。就是虚拟系统会通过宿主机的网络来访问外网，而这里的宿主机相当于有两个网卡，一个是真实网卡，一个是虚拟网卡，真实网卡相当于链接了现实世界的真实路由器，而宿主机的虚拟网卡，相当于连接了一个可以认为是虚拟交换机。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/1.png\" alt></p>\n<p><strong>虚拟机可以上网可以ping通主机，但是主机ping不通虚拟机。</strong></p>\n<ul>\n<li><strong>Bridged(桥接模式)</strong></li>\n</ul>\n<p>虚拟机和宿主机在网络上就是平级的关系，相当于连接在同一交换机上。</p>\n<p>需要手工为虚拟系统配置IP地址、子网掩码，而且还要和宿主机器处于同一网段，这样虚拟系统才能和宿主机器进行通信。以实现通过局域网的网关或路由器访问互联网。使用bridged模式的虚拟系统和宿主机器的关系，就像连接在同一个Hub上的两台电脑。相当于在一个局域网内创立了一个单独的主机，他可以访问这个局域网内的所有的主机，但是需要手动来配置IP地址，子网掩码，并且他是和真实主机在同一个网段（nat是两个网段）.</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/2.png\" alt></p>\n<p><strong>这个模式里，虚拟机和宿主机可以互相ping通。</strong></p>\n<h2 id=\"3】虚拟机网络设置\"><a href=\"#3】虚拟机网络设置\" class=\"headerlink\" title=\"3】虚拟机网络设置\"></a>3】虚拟机网络设置</h2><p><strong>右键点击以管理员身份打开VMware，找到要更改网络的虚拟机。</strong></p>\n<ul>\n<li>点击左上角【编辑虚拟机设置】→【网络适配器】→选择【桥接模式】，并勾选【复制物理网络连接状】态</li>\n</ul>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/3.png\" alt></p>\n<ul>\n<li>点击左上角【编辑E】→【虚拟网络编辑器】</li>\n</ul>\n<blockquote>\n<p> VMnet0、VMnet1、VMnet8，分别对应了桥接模式、仅主机模式、NAT模式。</p>\n</blockquote>\n<p><strong>选择【VMnet0】→【已桥接至】选择当前电脑连接的网络→【确定】</strong></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/4.png\" alt></p>\n<h2 id=\"3】CentOS网络设置\"><a href=\"#3】CentOS网络设置\" class=\"headerlink\" title=\"3】CentOS网络设置\"></a>3】CentOS网络设置</h2><ul>\n<li>查看自己电脑的IP网段（Win+R输入cmd再输入ipconfig）</li>\n</ul>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/5.png\" alt></p>\n<p><strong>将 IPv4 地址、子网掩码 、默认网关保存后面用到。</strong></p>\n<ul>\n<li>打开虚拟机，以root账户登录CentOS</li>\n</ul>\n<p>1.由于我安装了图形界面，登录是这样：</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/6.png\" alt></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/7.png\" alt></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/8.png\" alt></p>\n<p>说明：<strong>倘若没有设置root账户，但登录的账户yyo拥有root权限，那就直接登陆。</strong></p>\n<p>2.没有安装图形界面登录简单一些，我就不演示了。</p>\n<ul>\n<li>获取权限</li>\n</ul>\n<pre><code>sudo -i</code></pre><ul>\n<li>编辑配置ip地址信息文件（使用vi打开，CentOS自带vi）</li>\n</ul>\n<pre><code>vi /etc/sysconfig/network-scripts/ifcfg-ens33</code></pre><p>可以看到我们的网络配置文件：</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/9.png\" alt></p>\n<p><strong>按<code>i</code>进入编辑，按<code>方向键</code>移动</strong></p>\n<p>修改这两个值：</p>\n<pre><code>BOOTPROTO=static       #设置为手动分配IP地址\nONBOOT=yes</code></pre><p>在<code>ONBOOT=yes</code>后面增加四个值（上面我们保存的ip）：</p>\n<pre><code>IPADDR=192.168.0.107   # 配置为局域网固定IP(IPv4 地址)\nNETMASK=255.255.255.0  # 配置子网掩码\nGATEWAY=192.168.0.1    # 配置局域网网关\nDNS1=8.8.8.8           # 配置首选DNS，8.8.8.8为免费DNS服务器的IP地址</code></pre><p><strong>编辑完成后按<code>esc</code>退出，再按<code>:wq</code>保存（如果无法保存，就按<code>:wq！</code>强制保存）</strong></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/10.png\" alt></p>\n<ul>\n<li>接下来修改第二个配置，输入下面这个命令</li>\n</ul>\n<pre><code>vi /etc/sysconfig/network</code></pre><p>增加这四个配置：</p>\n<p><strong>按<code>i</code>进入编辑，按<code>方向键</code>移动</strong></p>\n<pre><code>NETWORKING=yes\nNETWORKING_IPV6=no            #关掉IPv6\nHOSTNAME=localhost.localdomain\nGATEWAY=192.168.0.1           #默认网关地址</code></pre><p><strong>编辑完成后按<code>esc</code>退出，再按<code>:wq</code>保存</strong></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/11.png\" alt></p>\n<ul>\n<li>启动network服务,输入下面这个命令</li>\n</ul>\n<pre><code>service network restart</code></pre><p><strong>使用CentOS 8.x 版本的就会有问题了，8以下的版本到这里就可以结束了。</strong></p>\n<p>事实上并没有启动network服务，而是：</p>\n<pre><code>Redirecting to /bin/systemctl reatart network.service\nFailed to restart network.service: Unit network.service not found</code></pre><p><strong>查了很多资料才发现centos 8.x 已经替换了原来的network, 新版的叫：NetworkManager，下面给出解决办法</strong></p>\n<ul>\n<li>首先安装NetworkManager</li>\n</ul>\n<pre><code>yum install NetworkManager*</code></pre><p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/12.png\" alt></p>\n<ul>\n<li>启动NetworkManager</li>\n</ul>\n<pre><code>service NetworkManager restart</code></pre><ul>\n<li>开启NetworkManager网络服务</li>\n</ul>\n<pre><code>systemctl status NetworkManager</code></pre><p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/13.png\" alt></p>\n<h2 id=\"4】验证网络\"><a href=\"#4】验证网络\" class=\"headerlink\" title=\"4】验证网络\"></a>4】验证网络</h2><ul>\n<li>在Windows终端ping我们CentOS的IP：192.168.0.107，可以正常通信。</li>\n</ul>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/14.png\" alt></p>\n<ul>\n<li>在CentOS验证一下，也是完全🆗</li>\n</ul>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/15.png\" alt></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/16.png\" alt></p>\n<p><strong>一番折腾下来，花费了不少时间，尤其是NetworkManager那里，都不想写这篇文章了，但是又想解决这个困难，希望对有需要朋友的有点帮助！</strong></p>\n<p>参考：</p>\n<p><a href=\"https://blog.csdn.net/YXWik/article/details/103163492\" target=\"_blank\" rel=\"noopener\">centos7输入systemctl status network.service出现Unit network.service could not be found的解决办法</a></p>\n<p><a href=\"https://blog.csdn.net/qq_40162735/article/details/101780012\" target=\"_blank\" rel=\"noopener\">Failed to restart network.service: Unit network.service not found</a></p>\n","excerpt":"","more":"<p>Linux版本：<code>CentOS</code></p>\n<p>CentOS发行版本：<code>CentOS 8.1</code></p>\n<p>虚拟机：<code>VMware</code></p>\n<p>在前面CentOS 8.1安装教程中关于网络配置我们默认使用的是NAT模式，这篇文章主要记录将我们的Linux网络设置由NAT模式改为桥接模式（Bridged）。</p>\n<p>需要安装CentOS的朋友可以可以看这篇文章：</p>\n<p><a href=\"https://muyiio.com/2020/03/05/vmware-an-zhuang-centos-8-1-wan-zheng-jiao-cheng/\" target=\"_blank\" rel=\"noopener\">VMware 安装 CentOS 8.1 完整教程</a></p>\n<h2 id=\"1】NAT与Bridged区别\"><a href=\"#1】NAT与Bridged区别\" class=\"headerlink\" title=\"1】NAT与Bridged区别\"></a>1】NAT与Bridged区别</h2><ul>\n<li><strong>NAT(网络地址转换模式)</strong></li>\n</ul>\n<p>虚拟机要联网得先通过宿主机才能和外面进行通信。</p>\n<p>NAT模式下的虚拟系统的TCP/IP配置信息是由VMnet8(NAT)虚拟网络的DHCP服务器提供的，无法进行手工修改，因此虚拟系统也就无法和本局域网中的其他真实主机进行通讯。使得虚拟局域网内的虚拟机在对外访问时，使用的则是宿主机的IP地址，这样从外部网络来  看，只能看到宿主机，完全看不到新建的虚拟局域网。就是虚拟系统会通过宿主机的网络来访问外网，而这里的宿主机相当于有两个网卡，一个是真实网卡，一个是虚拟网卡，真实网卡相当于链接了现实世界的真实路由器，而宿主机的虚拟网卡，相当于连接了一个可以认为是虚拟交换机。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/1.png\" alt></p>\n<p><strong>虚拟机可以上网可以ping通主机，但是主机ping不通虚拟机。</strong></p>\n<ul>\n<li><strong>Bridged(桥接模式)</strong></li>\n</ul>\n<p>虚拟机和宿主机在网络上就是平级的关系，相当于连接在同一交换机上。</p>\n<p>需要手工为虚拟系统配置IP地址、子网掩码，而且还要和宿主机器处于同一网段，这样虚拟系统才能和宿主机器进行通信。以实现通过局域网的网关或路由器访问互联网。使用bridged模式的虚拟系统和宿主机器的关系，就像连接在同一个Hub上的两台电脑。相当于在一个局域网内创立了一个单独的主机，他可以访问这个局域网内的所有的主机，但是需要手动来配置IP地址，子网掩码，并且他是和真实主机在同一个网段（nat是两个网段）.</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/2.png\" alt></p>\n<p><strong>这个模式里，虚拟机和宿主机可以互相ping通。</strong></p>\n<h2 id=\"3】虚拟机网络设置\"><a href=\"#3】虚拟机网络设置\" class=\"headerlink\" title=\"3】虚拟机网络设置\"></a>3】虚拟机网络设置</h2><p><strong>右键点击以管理员身份打开VMware，找到要更改网络的虚拟机。</strong></p>\n<ul>\n<li>点击左上角【编辑虚拟机设置】→【网络适配器】→选择【桥接模式】，并勾选【复制物理网络连接状】态</li>\n</ul>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/3.png\" alt></p>\n<ul>\n<li>点击左上角【编辑E】→【虚拟网络编辑器】</li>\n</ul>\n<blockquote>\n<p> VMnet0、VMnet1、VMnet8，分别对应了桥接模式、仅主机模式、NAT模式。</p>\n</blockquote>\n<p><strong>选择【VMnet0】→【已桥接至】选择当前电脑连接的网络→【确定】</strong></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/4.png\" alt></p>\n<h2 id=\"3】CentOS网络设置\"><a href=\"#3】CentOS网络设置\" class=\"headerlink\" title=\"3】CentOS网络设置\"></a>3】CentOS网络设置</h2><ul>\n<li>查看自己电脑的IP网段（Win+R输入cmd再输入ipconfig）</li>\n</ul>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/5.png\" alt></p>\n<p><strong>将 IPv4 地址、子网掩码 、默认网关保存后面用到。</strong></p>\n<ul>\n<li>打开虚拟机，以root账户登录CentOS</li>\n</ul>\n<p>1.由于我安装了图形界面，登录是这样：</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/6.png\" alt></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/7.png\" alt></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/8.png\" alt></p>\n<p>说明：<strong>倘若没有设置root账户，但登录的账户yyo拥有root权限，那就直接登陆。</strong></p>\n<p>2.没有安装图形界面登录简单一些，我就不演示了。</p>\n<ul>\n<li>获取权限</li>\n</ul>\n<pre><code>sudo -i</code></pre><ul>\n<li>编辑配置ip地址信息文件（使用vi打开，CentOS自带vi）</li>\n</ul>\n<pre><code>vi /etc/sysconfig/network-scripts/ifcfg-ens33</code></pre><p>可以看到我们的网络配置文件：</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/9.png\" alt></p>\n<p><strong>按<code>i</code>进入编辑，按<code>方向键</code>移动</strong></p>\n<p>修改这两个值：</p>\n<pre><code>BOOTPROTO=static       #设置为手动分配IP地址\nONBOOT=yes</code></pre><p>在<code>ONBOOT=yes</code>后面增加四个值（上面我们保存的ip）：</p>\n<pre><code>IPADDR=192.168.0.107   # 配置为局域网固定IP(IPv4 地址)\nNETMASK=255.255.255.0  # 配置子网掩码\nGATEWAY=192.168.0.1    # 配置局域网网关\nDNS1=8.8.8.8           # 配置首选DNS，8.8.8.8为免费DNS服务器的IP地址</code></pre><p><strong>编辑完成后按<code>esc</code>退出，再按<code>:wq</code>保存（如果无法保存，就按<code>:wq！</code>强制保存）</strong></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/10.png\" alt></p>\n<ul>\n<li>接下来修改第二个配置，输入下面这个命令</li>\n</ul>\n<pre><code>vi /etc/sysconfig/network</code></pre><p>增加这四个配置：</p>\n<p><strong>按<code>i</code>进入编辑，按<code>方向键</code>移动</strong></p>\n<pre><code>NETWORKING=yes\nNETWORKING_IPV6=no            #关掉IPv6\nHOSTNAME=localhost.localdomain\nGATEWAY=192.168.0.1           #默认网关地址</code></pre><p><strong>编辑完成后按<code>esc</code>退出，再按<code>:wq</code>保存</strong></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/11.png\" alt></p>\n<ul>\n<li>启动network服务,输入下面这个命令</li>\n</ul>\n<pre><code>service network restart</code></pre><p><strong>使用CentOS 8.x 版本的就会有问题了，8以下的版本到这里就可以结束了。</strong></p>\n<p>事实上并没有启动network服务，而是：</p>\n<pre><code>Redirecting to /bin/systemctl reatart network.service\nFailed to restart network.service: Unit network.service not found</code></pre><p><strong>查了很多资料才发现centos 8.x 已经替换了原来的network, 新版的叫：NetworkManager，下面给出解决办法</strong></p>\n<ul>\n<li>首先安装NetworkManager</li>\n</ul>\n<pre><code>yum install NetworkManager*</code></pre><p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/12.png\" alt></p>\n<ul>\n<li>启动NetworkManager</li>\n</ul>\n<pre><code>service NetworkManager restart</code></pre><ul>\n<li>开启NetworkManager网络服务</li>\n</ul>\n<pre><code>systemctl status NetworkManager</code></pre><p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/13.png\" alt></p>\n<h2 id=\"4】验证网络\"><a href=\"#4】验证网络\" class=\"headerlink\" title=\"4】验证网络\"></a>4】验证网络</h2><ul>\n<li>在Windows终端ping我们CentOS的IP：192.168.0.107，可以正常通信。</li>\n</ul>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/14.png\" alt></p>\n<ul>\n<li>在CentOS验证一下，也是完全🆗</li>\n</ul>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/15.png\" alt></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/MUYIio/CDN@1.8/Images/posts/NAT%E6%A8%A1%E5%BC%8F%E6%94%B9%E4%B8%BA%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/16.png\" alt></p>\n<p><strong>一番折腾下来，花费了不少时间，尤其是NetworkManager那里，都不想写这篇文章了，但是又想解决这个困难，希望对有需要朋友的有点帮助！</strong></p>\n<p>参考：</p>\n<p><a href=\"https://blog.csdn.net/YXWik/article/details/103163492\" target=\"_blank\" rel=\"noopener\">centos7输入systemctl status network.service出现Unit network.service could not be found的解决办法</a></p>\n<p><a href=\"https://blog.csdn.net/qq_40162735/article/details/101780012\" target=\"_blank\" rel=\"noopener\">Failed to restart network.service: Unit network.service not found</a></p>\n","path":"linux-wang-luo-she-zhi-centos-you-nat-mo-shi-gai-wei-qiao-jie-mo-shi.html","permalink":"https://www.yshawlon.cn/linux-wang-luo-she-zhi-centos-you-nat-mo-shi-gai-wei-qiao-jie-mo-shi.html","tags":[{"name":"CentOS","_id":"clq6dy4b4004mikw0kjkqwur8","slug":"CentOS","path":"tags/CentOS/","permalink":"https://www.yshawlon.cn/tags/CentOS/","length":2},{"name":"NAT","_id":"clq6dy4b6004vikw042mlvy5k","slug":"NAT","path":"tags/NAT/","permalink":"https://www.yshawlon.cn/tags/NAT/","length":1},{"name":"Bridged","_id":"clq6dy4b7004xikw0n9ogajq2","slug":"Bridged","path":"tags/Bridged/","permalink":"https://www.yshawlon.cn/tags/Bridged/","length":1}],"categories":[{"name":"Linux","_id":"clq6dy49y0024ikw00kgeztib","slug":"Linux","path":"categories/Linux/","permalink":"https://www.yshawlon.cn/categories/Linux/","length":3}],"prev":{"title":"Hexo 博客代码块样式美化","date":"2020-04-03T12:26:29.000Z","summary":"本文记录对博客代码块进行美化增加了语言识别、copy、行号等等。","slug":"Hexo-博客代码块样式美化","published":true,"updated":"2021-05-18T08:34:57.229Z","_id":"clq6dy48m000qikw0y30o79kl","layout":"post","photos":[],"link":"","excerpt":"","path":"hexo-bo-ke-dai-ma-kuai-yang-shi-mei-hua.html","permalink":"https://www.yshawlon.cn/hexo-bo-ke-dai-ma-kuai-yang-shi-mei-hua.html","__post":true},"next":{"title":"Linux学习笔记-Vim编辑器","date":"2020-03-31T10:41:54.000Z","summary":"vi和vim都是Linux中的编辑器，vim比较高级，可以视为vi的升级版本。","slug":"Linux学习笔记-Vim编辑器","published":true,"updated":"2021-05-18T10:35:06.015Z","_id":"clq6dy48z001cikw0n1ncprfk","layout":"post","photos":[],"link":"","excerpt":"","path":"linux-xue-xi-bi-ji-vim-bian-ji-qi.html","permalink":"https://www.yshawlon.cn/linux-xue-xi-bi-ji-vim-bian-ji-qi.html","__post":true},"__post":true}